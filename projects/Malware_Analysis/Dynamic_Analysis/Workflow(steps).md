
# üß™ Dynamic Analysis Workflow ‚Äî `mal17.exe`

This document records the complete **dynamic analysis workflow** performed on the suspicious file **`mal17.exe`**, showing each step, tool, command, and observation chronologically.

---

## ‚öôÔ∏è Environment Setup

1. Booted up **Windows 10 VM** (analysis victim) and **Remnux VM** (network simulator).
2. Configured both on a **Host-Only Network** so that all outbound traffic would route to INetSim on Remnux.
3. Confirmed connectivity between both VMs via ping:
   ```bash
   ping 192.168.195.101   # From Windows to Remnux
4. On Remnux, started INetSim:
   ```
    inetsim
  This allowed fake internet services (HTTP, HTTPS, DNS, SMTP, etc.) to capture the malware‚Äôs taffic.

  - [`Click here to view`](../../../assets/images/Malware_Analysis/inetsim.png) 
  ---

  ## üß∞ Tools Launched Before Execution

- Regshot ‚Üí Took the first snapshot for baseline registry comparison.
- Process Explorer ‚Üí Opened to monitor process creation and network activity.
- Wireshark ‚Üí Started packet capture on the host-only adapter (Ethernet 2).
- Procmon (Process Monitor) ‚Üí Started to capture real-time file/registry/syscall activity (high-detail tracing)
  
All baseline conditions were clean with no suspicious activity yet.

---

### üöÄ Step 1: Execution of the Sample

- Executed mal17.exe (appears disguised as winrar.exe).
- Immediately observed a new process in Process Explorer
`VioletClient3335_protected.exe` [`Click here to view`](../../../assets/images/Malware_Analysis/process.png) 
- It was created to the path `C: Users\nasir\AppData\Roaming\VioletClient3335_protected.exe` [`Click here to view`](../../../assets/images/Malware_Analysis/voipath.png) 
- The new process attempted outbound TCP connections to:`5.175.234.65:7000` [`Click here to view`](../../../assets/images/Malware_Analysis/syn.png) 
- TCP state remained in SYN_SENT, meaning connection attempts were made but not completed a typical sign of beaconing to a Command & Control (C2) server, blocked by INetSim`
- [`Click here to view`](../../../assets/images/Malware_Analysis/syn.png) 
---

### üåê Step 2: Monitoring Network Activity (Wireshark)

- Wireshark capture was active during execution.
- Notable packets captured
  ```
     301	148.641950803	192.168.195.102	192.168.195.101	TCP	62	51581 ‚Üí 80 [ACK] Seq=112 Ack=249 Win=262400 Len=0
     302	148.643345129	192.168.195.102	192.168.195.101	TCP	62	51581 ‚Üí 80 [FIN, ACK] Seq=112 Ack=249 Win=262400 Len=0
     303	148.643382272	192.168.195.101	192.168.195.102	TCP	56	80 ‚Üí 51581 [ACK] Seq=249 Ack=113 Win=64256 Len=0
     304	149.187309721	192.168.195.102	5.175.234.65	TCP	68	[TCP Retransmission] 51580 ‚Üí 7000 [SYN] Seq=0 Win=51200 Len=0 MSS=1460 WS=1 SACK_PERM
     305	149.880458730	192.168.195.102	192.168.195.101	TCP	68	51582 ‚Üí 443 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=256 SACK_PERM
  ```
Findings:
- The malware attempted to resolve windows.msn.com ‚Äî likely a network connectivity test or disguise.
- The external IP 5.175.234.65 (Germany) was contacted repeatedly on port 7000. [`Click here to view`](../../../assets/images/Malware_Analysis/fakeIP.png) 
- VirusTotal later confirmed this IP was malicious (8 detections). [`Click here to view`](../../../assets/images/Malware_Analysis/virusIP.png) 

---

### üß© Step 3: INetSim Response Capture

On the Remnux terminal running INetSim:
  ```
  [dns_53_tcp_udp] Query: self.events.data.microsoft.com
  [http_80_tcp] Request: GET /connecttest.txt Host: www.msftconnecttest.com
  [https_443_tcp] SSL accept attempt failed
  ```
This confirmed that:
- The malware was checking for internet connectivity.
- It attempted to make HTTP/HTTPS requests to mimic normal Windows behavior.
- The SSL error occurred because INetSim used fake certificates ‚Äî expected in this simulation.

---

### üß† Step 4: Registry and File System Monitoring (Regshot)

After approximately 5 minutes of runtime:
- Took the second Regshot snapshot.
- Compared it to the baseline snapshot.
Result summary:
  ```
  ----------------------------------
  Total changes detected: 182
  ----------------------------------
    ```
  [`Click here to view`](../../../assets/images/Malware_Analysis/regshot1.png) 
 ---


### üß± Step 5: Process Analysis

During runtime, Process Explorer showed:
- Parent process: `mal17.exe`
- Child process: `VioletClient3335_protected.exe`
- Network tab: attempted connection to `5.175.234.65:7000` [`Click here to view`](../../../assets/images/Malware_Analysis/syn.png) 
No GUI window appeared, and the malware terminated quietly after a few minutes.
The **child executable** remained on disk ‚Äî indicating **dropper behavior.**

---

### üß¨ Step 6: Verification on VirusTotal

The dropped file `VioletClient3335_protected.exe` was hashed and submitted to VirusTotal.
Results:
- Detection: 57 / 72 [`Click here to view`](../../../assets/images/Malware_Analysis/VirusTotalHash.png) 
- SHA256: `d93341e2f46e377d017b6c98b109c196c82ff9bc077d6ad309d6ae58f1f45bde`
- Classification: Trojan Downloader / Dropper
- Malicious IPs Contacted:
    `5.175.234.65 (DE) ‚Äî 8/95 detections` [`Click here to view`](../../../assets/images/Malware_Analysis/virusIP.png) 

 Conclusion:
`mal17.exe` serves as a dropper ‚Äî downloading or creating a secondary executable `(VioletClient3335_protected.exe)` and attempting to connect to remote C2 infrastructure.

---

### üß† Step 7: Conclusion

The dynamic analysis confirmed that:
The sample behaves like a network-aware dropper, using obfuscation and fake Microsoft URLs.
It attempts TCP beacons to a known malicious IP (port 7000).
It drops and executes another payload (VioletClient3335_protected.exe).
Registry activity shows signs of camouflage under legitimate Microsoft paths.


### üß† Final Note:
- This analysis was performed safely in an isolated lab using Remnux + Windows VMs.
- No internet connectivity was provided to prevent real-world propagation.
- All screenshots associated with this analysis can be found  [`here `](../../../assets/images/Malware_Analysis/) 

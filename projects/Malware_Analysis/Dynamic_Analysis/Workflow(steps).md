
# üß™ Dynamic Analysis Workflow ‚Äî `mal17.exe`

This document records the complete **dynamic analysis workflow** performed on the suspicious file **`mal17.exe`**, showing each step, tool, command, and observation chronologically.

---

## ‚öôÔ∏è Environment Setup

1. Booted up **Windows 10 VM** (analysis victim) and **Remnux VM** (network simulator).
2. Configured both on a **Host-Only Network** so that all outbound traffic would route to INetSim on Remnux.
3. Confirmed connectivity between both VMs via ping:
   ```bash
   ping 192.168.195.101   # From Windows to Remnux
4. On Remnux, started INetSim:
   ```
   sudo systemctl start inetsim
   sudo tail -f /var/log/inetsim/service.log

  This allowed fake internet services (HTTP, HTTPS, DNS, SMTP, etc.) to capture the malware‚Äôs taffic.
  
  ---

  ## üß∞ Tools Launched Before Execution

- Regshot ‚Üí Took the first snapshot for baseline registry comparison.
- Process Explorer ‚Üí Opened to monitor process creation and network activity.
- Wireshark ‚Üí Started packet capture on the host-only adapter (Ethernet 2).

All baseline conditions were clean with no suspicious activity yet.

---

### üöÄ Step 1: Execution of the Sample

- Executed mal17.exe (appears disguised as winrar.exe).
- Immediately observed a new process in Process Explorer
`VioletClient3335_protected.exe`
- The new process attempted multiple outbound TCP connections to:`www.inetsim.org:7000
- TCP state remained in SYN_SENT, meaning connection attempts were made but not completed a typical sign of beaconing to a Command & Control (C2) server, blocked by INetSim`

---

### üåê Step 2: Monitoring Network Activity (Wireshark)

- Wireshark capture was active during execution.
- Notable packets captured
  ```
      574  237.212974  192.168.195.102 ‚Üí 192.168.195.101  DNS  Query for windows.msn.com
      1154 527.522811  192.168.195.102 ‚Üí 5.175.234.65     TCP  SYN to port 7000 (no response)
  ```
Findings:
- The malware attempted to resolve windows.msn.com ‚Äî likely a network connectivity test or disguise.
- The external IP 5.175.234.65 (Germany) was contacted repeatedly on port 7000.
- VirusTotal later confirmed this IP was malicious (8 detections).

---

### üß© Step 3: INetSim Response Capture

On the Remnux terminal running INetSim:
  ```
  [dns_53_tcp_udp] Query: self.events.data.microsoft.com
  [http_80_tcp] Request: GET /connecttest.txt Host: www.msftconnecttest.com
  [https_443_tcp] SSL accept attempt failed
  ```
This confirmed that:
- The malware was checking for internet connectivity.
- It attempted to make HTTP/HTTPS requests to mimic normal Windows behavior.
- The SSL error occurred because INetSim used fake certificates ‚Äî expected in this simulation.

---

### üß† Step 4: Registry and File System Monitoring (Regshot)

After approximately 3 minutes of runtime:
- Took the second Regshot snapshot.
- Compared it to the baseline snapshot.
Result summary:
  ```
  ----------------------------------
  Total changes detected: 182
  ----------------------------------
    ```
    ---


### üß± Step 5: Process Analysis

During runtime, Process Explorer showed:
- Parent process: `mal17.exe`
- Child process: `VioletClient3335_protected.exe`
- Network tab: attempted connection to www.inetsim.org:7000
No GUI window appeared, and the malware terminated quietly after a few minutes.
The **child executable** remained on disk ‚Äî indicating **dropper behavior.**

---

### üß¨ Step 6: Verification on VirusTotal

The dropped file `VioletClient3335_protected.exe` was submitted to VirusTotal.
Results:
- Detection: 57 / 72
- SHA256: `d93341e2f46e377d017b6c98b109c196c82ff9bc077d6ad309d6ae58f1f45bde`
- Classification: Trojan Downloader / Dropper
- Malicious IPs Contacted:
   - 5.175.234.65 (DE) ‚Äî 8/95 detections`
  - `23.195.81.59 and 23.195.81.72 ‚Äî benign Akamai IPs used for disguise`

 Conclusion:
`mal17.exe` serves as a dropper ‚Äî downloading or creating a secondary executable `(VioletClient3335_protected.exe)` and attempting to connect to remote C2 infrastructure.

---

### üß† Step 7: Conclusion

The dynamic analysis confirmed that:
The sample behaves like a network-aware dropper, using obfuscation and fake Microsoft URLs.
It attempts TCP beacons to a known malicious IP (port 7000).
It drops and executes another payload (VioletClient3335_protected.exe).
Registry activity shows signs of camouflage under legitimate Microsoft paths.


### üß† Final Note:
This analysis was performed safely in an isolated lab using Remnux + Windows VMs.
No internet connectivity was provided to prevent real-world propagation.


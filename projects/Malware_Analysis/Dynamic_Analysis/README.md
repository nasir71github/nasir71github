# üß™ Dynamic Malware Analysis Report ‚Äì `mal17.exe`

## üìò Overview
This report documents the **dynamic analysis** of the suspicious executable **`mal17.exe`**, which was observed masquerading as a legitimate `winrar.exe` file.  
The analysis was performed in a **controlled lab environment** using a Windows VM (for execution) and a Remnux VM (for network simulation with INetSim).  
The primary objective was to **observe runtime behavior**, including **process activity, network connections, dropped files, and registry modifications**.

---

## ‚öôÔ∏è Environment Setup

| Component | Description |
|------------|-------------|
| **Host System** | FLARE VM (Windows 10) |
| **Network Host** | Remnux Linux with INetSim |
| **Isolation** | Air-gapped, bridged network only between VMs |
| **Sample** | `mal17.exe` (masquerading as WinRAR installer) |
| **Tools Used** | Process Explorer,Process Monitor, Wireshark, INetSim, Regshot, VirusTotal |

---

## üîç Summary of Findings

### 1. **Initial Execution**
Upon execution, the sample attempted multiple outbound connections to external IPs on **TCP port 7000**, showing typical **beaconing behavior** consistent with command-and-control (C2) communication attempts.

- Destination observed: `www.inetsim.org:7000`
- Corresponding INetSim logs confirmed multiple connection attempts.
- Wireshark captured SYN packets repeatedly sent without a successful handshake.

---

### 2. **Network Behavior (INetSim & Wireshark)**

| Observation | Details |
|--------------|----------|
| **DNS Requests** | `windows.msn.com`, `self.events.data.microsoft.com`, `www.msftconnecttest.com` |
| **TCP Activity** | SYN requests to `5.175.234.65:7000` (flagged as malicious by 8 vendors) |
| **HTTP Activity** | INetSim emulated responses to Microsoft NCSI (`connecttest.txt`) |
| **SSL Errors** | INetSim reported repeated `SSL accept failed` errors, indicating the malware tried HTTPS C2 connections. |

These activities suggest **network reach-out behavior**, likely for **command retrieval or system fingerprinting**.

---

### 3. **Process Activity (Process Explorer)**
- The process tree showed the creation of a suspicious executable:
mal17.exe ‚Üí VioletClient3335_protected.exe
- `VioletClient3335_protected.exe` attempted connections to `inetsim.org:7000`.
- Its TCP state remained **SYN_SENT**, confirming blocked or emulated outbound traffic.
- The process did not terminate immediately, suggesting a persistence or retry mechanism.

---

### 4. **Registry Modifications (Regshot)**
A total of **182 registry changes** were detected post-execution.  
Most modifications were related to **Office telemetry and cache keys**, possibly used for obfuscation or as noise to mask its actual changes.

**Potentially relevant entries:**

`HKU\S-1-5-18\Software\Microsoft\Office\16.0\Common\ClientTelemetry`

`HKU\S-1-5-18\Software\Microsoft\Office\16.0\Common\Internet\WebServiceCache`

**These could indicate attempts to blend with normal Microsoft Office telemetry data.**

---

### 5. **Dropped Files**
The malware dropped: **VioletClient3335_protected.exe**

#### VirusTotal analysis:
- **Detection:** 57/72 vendors flagged it as malicious.
- **SHA256:** `d93341e2f46e377d017b6c98b109c196c82ff9bc077d6ad309d6ae58f1f45bde`
- **Behavior:** Acts as a downloader/dropper, attempting outbound C2 connections.

---

## üß© Behavioral Summary

| Behavior | Description |
|-----------|--------------|
| **Persistence** | Possible via registry modifications |
| **Network Beaconing** | Attempts to reach external C2 servers over ports **7000, 443** |
| **Dropped Executables** | Secondary payload (`VioletClient3335_protected.exe`) |
| **Anti-analysis Signs** | SSL negotiation failures (possibly due to fake certs) |
| **System Impact** | No immediate destructive behavior observed |

---

## üìä Key Indicators of Compromise (IOCs)

| Type | Indicator |
|------|------------|
| **File Name** | `mal17.exe`, `VioletClient3335_protected.exe` |
| **SHA256** | `d93341e2f46e377d017b6c98b109c196c82ff9bc077d6ad309d6ae58f1f45bde` |
| **IP Address** | `5.175.234.65` (Germany, 8 detections on virusTotal) |
| **Port** | TCP 7000, 443 |

---

## üß† Analysis Conclusion
The dynamic analysis reveals that **`mal17.exe` is a dropper-type malware** that deploys a secondary payload (`VioletClient3335_protected.exe`) and attempts to connect to a C2 server using **TCP port 7000**.  
Its network activity and persistence-like behavior suggest it may serve as part of a **larger remote control or data exfiltration campaign**.

INetSim successfully intercepted and logged these requests, preventing external communication.

---

# Malware Analysis Report – `mal17.exe` 

- Date: 2025-10-09
- Analyst: [Emmanuel Owusu Akrofi/SOC]
- Case ID: MAL-2025-10-09-0

---

## Executive Summary
This report documents the full malware analysis process conducted on a suspicious Windows executable named **`mal17.exe`**, which was later identified as a dropper that deploys and executes a secondary payload (**`VioletClient3335_protected.exe`**).  

The analysis was divided into **static** and **dynamic** phases within a controlled environment using **Remnux** and a **Windows sandbox**.  
Static inspection revealed .NET-based obfuscation, encrypted strings, and embedded payloads, while dynamic testing confirmed file dropping and network communication attempts.  

Findings indicate that the sample acts as a **malicious dropper** designed to deploy additional payloads and initiate outbound C2 communications. The infection did not exhibit persistence mechanisms during observation but maintains the potential for future remote control or data exfiltration.

---
## Scope & objectives

- **Scope:** Single VM analysis (user: nasir), sample `C:\Users\nasir\Desktop\flare\mal17.exe`, dropped executable `%APPDATA%\VioletClient3335_protected.exe.`
- **Objectives:**
  - Determine runtime behavior and network activity of `mal17.exe.`
  - Confirm whether `mal17.exe` drops and executes secondary payload(s).
  - Extract IOCs (hashes, paths, IPs).
  - Provide containment and detection recommendations.
---
## Overview
This repository contains a two-phase malware analysis of `mal17.exe`, which on execution drops `VioletClient3335_protected.exe` into the user’s AppData directory.  
The primary goal was to determine its behavior, indicators of compromise (IOCs), and overall threat classification.

---

## Key Findings

### Static Analysis
- The executable is a **.NET binary** with **obfuscated and encrypted strings**.
- Presence of **Base64 and Rijndael encryption routines** indicates runtime payload decryption.
- Embedded routines for **file dropping and process creation**.
- Classified as a **dropper** capable of unpacking or downloading additional binaries.

### Dynamic Analysis
- Executing `mal17.exe` dropped `VioletClient3335_protected.exe` in:
C:\Users\nasir\AppData\Roaming\VioletClient3335_protected.exe
- Process Explorer showed attempted **outbound TCP connection** to `5.175.234.65:7000`.
- **Wireshark** captured DNS queries and SYN packets suggesting blocked or simulated C2 communication.
- **INetSim** registered HTTP and DNS activity.
- **Regshot** detected registry activity without evidence of persistence.
- **VirusTotal**: `57/72` vendors flagged the file as malicious.

---

## Threat Assessment
| Indicator | Description |
|------------|--------------|
| Type | Dropper / Downloader |
| Behavior | Drops and executes secondary payload |
| Impact | Enables remote code execution and potential data exfiltration |
| Severity | High |
| Confidence | High |

---

## MITRE ATT&CK Mapping
| Technique | Description |
|------------|-------------|
| T1071 | Application Layer Protocol (HTTP C2) |
| T1105 | Ingress Tool Transfer |
| T1027 | Obfuscated Files or Information |
| T1140 | Deobfuscation / Decryption of Payloads |
| T1059 | Command Execution via Dropped Payload |

---

## Indicators of Compromise (IOCs)
| Type | Indicator |
|------|------------|
| SHA256 | `d93341e2f46e377d017b6c98b109c196c82ff9bc077d6ad309d6ae58f1f45bde` |
| Dropped File | `%APPDATA%\VioletClient3335_protected.exe` |
| C2 IP | `5.175.234.65:7000` |
| Domains | `windows.msn.com`, `self.events.data.microsoft.com` |

---

## Tools Used
| Category | Tools |
|-----------|-------|
| Static Analysis | Detect-It-Easy, dnSpy, PEStudio, strings,binwalk,peframe, VirusTotal |
| Dynamic Analysis | Regshot, Process Explorer, Procmon, Wireshark, INetSim, VirusTotal |

---

## Summary
Analysis confirms that `mal17.exe` functions as a **dropper** responsible for delivering a protected payload.  
The malware attempts network communication with a potential command-and-control server but is effectively contained in a simulated INetSim environment.  
No persistence or privilege escalation was detected in this session, suggesting that the infection relies on user execution to initiate further stages.

For in-depth details, see:
- [Static Analysis Report](./Static_Analysis/README.md)  
- [Dynamic Analysis Report ](./Dynamic_Analysis/README.md)

---

## Containment, Eradication & Recovery
- **Containment:** Immediately isolate infected hosts to prevent network propagation.  
- **Eradication:** Delete both executables (`mal17.exe`, `VioletClient3335_protected.exe`) and related temp files.  
- **Recovery:** Perform a full system scan, verify system integrity, and re-enable security tools.  
- **Verification:** Monitor for reoccurring connections to known IOCs post-remediation.

---

## Assessment & Impact
- **Impact Level:** High  
- **Affected Systems:** Windows environments at user privilege level  
- **Primary Risk:** Secondary payload delivery and potential remote access  
- **Operational Impact:** May allow remote execution or credential theft if uncontained.
- **Business impact:** If run on a production host with internet access, the sample could establish C2, download additional payloads, exfiltrate data, or enable lateral movement

---
## Detection & hunting
- **Endpoint:** Alert on creation/execution of process with path pattern `%APPDATA%\*VioletClient*` or on parent `mal17.exe` spawning child processes; monitor process creation where parent is `unknown/desktop` path executables.
- **Network:** IDS rule for repeated TCP SYNs to `5.175.234.65 on port 7000`; detections for unusual HTTP User-Agents performing NCSI-like requests from non-Windows network flows.
- **SIEM:** Log and alert on file hash `d93341e2f46e377d017b6c98b109c196c82ff9bc077d6ad309d6ae58f1f45bde` and other hashes from samples; track unusual outbound connection attempts from workstations to listed IOCs.
- **YARA:** Create YARA rules for observed strings, obfuscation markers `(e.g., $VB$Local_base64Exe, ObfuscatedByGoliath, ConfusedBy)`, and known structural traits of the sample
---

## Recommendations
- Apply latest OS and application security patches.  
- Monitor outbound connections to unknown IPs or ports (especially `TCP 7000`).  
- Enforce least privilege and block execution from user directories such as `%AppData%`.  
- Use endpoint detection and response (EDR) tools for early dropper detection.  
- Maintain regular backups and test recovery procedures.

---

**Status:** Completed – Static & Dynamic Analysis  
**Environment:** Remnux + Windows Analysis VM  
**Classification:** Malicious Dropper / Downloader

